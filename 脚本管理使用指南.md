# GoDBModeler è„šæœ¬ç®¡ç†åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

è„šæœ¬ç®¡ç†åŠŸèƒ½å…è®¸æ‚¨åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å’Œé‡ç”¨è‡ªå®šä¹‰ JavaScript è„šæœ¬ï¼Œç”¨äºç”Ÿæˆé«˜åº¦å®šåˆ¶åŒ–çš„ TypeScript ä»£ç ã€‚æ”¯æŒä»æ–‡ä»¶ç³»ç»Ÿå¯¼å…¥è„šæœ¬æ–‡ä»¶ï¼Œå¹¶æä¾›ä¸°å¯Œçš„ç¤ºä¾‹æ¨¡æ¿ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è®¿é—®è„šæœ¬ç®¡ç†
1. å¯åŠ¨ GoDBModeler åº”ç”¨ç¨‹åº
2. åˆ‡æ¢åˆ°"è„šæœ¬ç®¡ç†"æ ‡ç­¾é¡µ
3. æ‚¨å°†çœ‹åˆ°å·¦ä¾§çš„è„šæœ¬åˆ—è¡¨å’Œå³ä¾§çš„é¢„è§ˆåŒºåŸŸ

### 2. åˆ›å»ºæ–°è„šæœ¬
1. ç‚¹å‡»"æ–°å¢è„šæœ¬"æŒ‰é’®
2. è¾“å…¥è„šæœ¬åç§°å’Œå†…å®¹
3. ç‚¹å‡»"ä¿å­˜"æŒ‰é’®
4. è„šæœ¬å°†ä¿å­˜åˆ°åº”ç”¨ç¨‹åºé…ç½®ç›®å½•

### 3. å¯¼å…¥å¤–éƒ¨è„šæœ¬
1. ç‚¹å‡»"å¯¼å…¥è„šæœ¬"æŒ‰é’®
2. é€‰æ‹©æœ¬åœ°çš„ `.js` æ–‡ä»¶
3. ç¡®è®¤è„šæœ¬åç§°å’Œå†…å®¹
4. æ–‡ä»¶å°†ä¿å­˜åˆ° `~/.godbmodeler/scripts/imported/` ç›®å½•

### 4. ä½¿ç”¨è„šæœ¬
1. åœ¨"TSæ¨¡å‹ç”Ÿæˆ"æ ‡ç­¾é¡µä¸­
2. ä»è„šæœ¬ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©å·²ä¿å­˜çš„è„šæœ¬
3. æˆ–è€…ç‚¹å‡»"åŠ è½½è„šæœ¬"æŒ‰é’®é€‰æ‹©è„šæœ¬æ–‡ä»¶

## ğŸ“ æ–‡ä»¶å­˜å‚¨ä½ç½®

### åº”ç”¨ç¨‹åºç®¡ç†çš„è„šæœ¬
- ä½ç½®: `~/.godbmodeler/config.json`
- ç‰¹ç‚¹: ä¸åº”ç”¨ç¨‹åºé…ç½®ä¸€èµ·å­˜å‚¨
- ç®¡ç†: é€šè¿‡åº”ç”¨ç¨‹åºç•Œé¢ç®¡ç†

### å¯¼å…¥çš„è„šæœ¬æ–‡ä»¶
- ä½ç½®: `~/.godbmodeler/scripts/imported/`
- ç‰¹ç‚¹: ç‹¬ç«‹çš„ `.js` æ–‡ä»¶
- ç®¡ç†: å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘æˆ–é€šè¿‡åº”ç”¨ç¨‹åºå¯¼å…¥

## ğŸ¯ è„šæœ¬ç¼–å†™æŒ‡å—

### è¾“å…¥å¯¹è±¡ç»“æ„
```javascript
// input å¯¹è±¡åŒ…å«å®Œæ•´çš„è¡¨ç»“æ„ä¿¡æ¯
input = {
  tableName: "users",           // è¡¨å
  comment: "ç”¨æˆ·è¡¨",            // è¡¨æ³¨é‡Š
  fields: [                     // å­—æ®µæ•°ç»„
    {
      name: "id",              // å­—æ®µå
      type: "int",             // æ•°æ®åº“ç±»å‹
      tsType: "number",        // TypeScript ç±»å‹
      isPrimary: true,         // æ˜¯å¦ä¸»é”®
      isNullable: false,       // æ˜¯å¦å¯ä¸ºç©º
      comment: "ç”¨æˆ·ID",       // å­—æ®µæ³¨é‡Š
      defaultValue: null       // é»˜è®¤å€¼
    },
    // ... æ›´å¤šå­—æ®µ
  ],
  indexes: [...],               // ç´¢å¼•ä¿¡æ¯
  foreignKeys: [...]           // å¤–é”®ä¿¡æ¯
}
```

### å¿…é¡»è®¾ç½®çš„å˜é‡
```javascript
// å¿…é¡»è®¾ç½® output å˜é‡ä½œä¸ºæœ€ç»ˆè¾“å‡º
output = "ç”Ÿæˆçš„TypeScriptä»£ç ";

// å¯ä»¥ä½¿ç”¨ console.log() è¿›è¡Œè°ƒè¯•
console.log("å¼€å§‹ç”Ÿæˆä»£ç ...");
```

### å¸¸ç”¨å·¥å…·å‡½æ•°
```javascript
// æ•°æ®åº“ç±»å‹åˆ° TypeScript ç±»å‹æ˜ å°„
function mapType(dbType) {
  const typeMap = {
    'int': 'number',
    'varchar': 'string', 
    'datetime': 'Date',
    'boolean': 'boolean'
  };
  return typeMap[dbType.toLowerCase()] || 'any';
}

// è½¬æ¢ä¸ºé©¼å³°å‘½å
function toCamelCase(str) {
  return str.replace(/_([a-z])/g, (g) => g[1].toUpperCase());
}

// è½¬æ¢ä¸ºå¸•æ–¯å¡å‘½å
function toPascalCase(str) {
  const camel = toCamelCase(str);
  return camel.charAt(0).toUpperCase() + camel.slice(1);
}
```

## ğŸ“ ç¤ºä¾‹è„šæœ¬æ¨¡æ¿

### 1. åŸºç¡€æ¥å£ç”Ÿæˆ
```javascript
// ç”ŸæˆåŸºç¡€çš„ TypeScript æ¥å£
let output = `export interface ${input.tableName} {\n`;

input.fields.forEach(field => {
  output += `  ${field.name}: ${field.tsType};\n`;
});

output += '}\n';
```

### 2. å¸¦å®Œæ•´æ³¨é‡Šçš„æ¥å£
```javascript
// ç”Ÿæˆå¸¦å®Œæ•´æ³¨é‡Šçš„æ¥å£
let output = `/**\n * ${input.tableName} å®ä½“æ¥å£\n */\n`;
output += `export interface ${input.tableName} {\n`;

input.fields.forEach(field => {
  output += `  /**\n   * ${field.comment || field.name}\n`;
  output += `   * ç±»å‹: ${field.type}\n`;
  if (field.isPrimary) output += `   * ä¸»é”®å­—æ®µ\n`;
  if (field.isNullable) output += `   * å…è®¸ä¸ºç©º\n`;
  output += `   */\n`;
  output += `  ${field.name}${field.isNullable ? '?' : ''}: ${field.tsType};\n\n`;
});

output += '}\n';
```

### 3. ç”Ÿæˆ DTO ç±»
```javascript
// ç”Ÿæˆåˆ›å»ºå’Œæ›´æ–° DTO
let output = '';

// åˆ›å»º DTO
output += `export interface Create${input.tableName}Dto {\n`;
input.fields.forEach(field => {
  if (!field.isPrimary) {
    output += `  ${field.name}${field.isNullable ? '?' : ''}: ${field.tsType};\n`;
  }
});
output += '}\n\n';

// æ›´æ–° DTO  
output += `export interface Update${input.tableName}Dto {\n`;
input.fields.forEach(field => {
  if (!field.isPrimary) {
    output += `  ${field.name}?: ${field.tsType};\n`;
  }
});
output += '}\n';
```

### 4. ç”Ÿæˆ GraphQL ç±»å‹
```javascript
// ç”Ÿæˆ GraphQL Schema
let output = `# ${input.tableName} GraphQL ç±»å‹å®šä¹‰\n`;
output += `type ${input.tableName} {\n`;

input.fields.forEach(field => {
  const gqlType = mapToGraphQLType(field.tsType);
  output += `  ${field.name}: ${gqlType}${field.isNullable ? '' : '!'}\n`;
});

output += '}\n\n';

function mapToGraphQLType(tsType) {
  const map = {
    'number': 'Float',
    'string': 'String', 
    'boolean': 'Boolean',
    'Date': 'String'
  };
  return map[tsType] || 'String';
}
```

### 5. ç”Ÿæˆ Prisma Schema
```javascript
// ç”Ÿæˆ Prisma æ¨¡å‹å®šä¹‰
let output = `// ${input.tableName} Prisma æ¨¡å‹\n`;
output += `model ${input.tableName} {\n`;

input.fields.forEach(field => {
  const prismaType = mapToPrismaType(field.type);
  output += `  ${field.name} ${prismaType}${field.isPrimary ? ' @id' : ''}${field.isNullable ? '' : ''}\n`;
});

output += '}\n\n';

function mapToPrismaType(dbType) {
  const map = {
    'int': 'Int',
    'varchar': 'String',
    'text': 'String',
    'datetime': 'DateTime',
    'boolean': 'Boolean'
  };
  return map[dbType.toLowerCase()] || 'String';
}
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### æ¡ä»¶ç”Ÿæˆ
```javascript
// æ ¹æ®æ¡ä»¶ç”Ÿæˆä¸åŒçš„ä»£ç 
let output = '';

if (input.tableName.includes('Log') || input.tableName.includes('History')) {
  // æ—¥å¿—è¡¨ç‰¹æ®Šå¤„ç†
  output = generateLogInterface(input);
} else if (input.fields.some(f => f.isPrimary)) {
  // æœ‰ä¸»é”®çš„è¡¨
  output = generateStandardInterface(input);
} else {
  // å…¶ä»–è¡¨
  output = generateBasicInterface(input);
}
```

### ä»£ç æ ¼å¼åŒ–
```javascript
// è‡ªåŠ¨æ ¼å¼åŒ–ç”Ÿæˆçš„ä»£ç 
function formatCode(code) {
  // ç¼©è¿›å¤„ç†
  code = code.replace(/^  /gm, '  ');
  
  // ç©ºè¡Œå¤„ç†
  code = code.replace(/\n\s*\n/g, '\n\n');
  
  // ç»“å°¾æ¢è¡Œ
  if (!code.endsWith('\n')) {
    code += '\n';
  }
  
  return code;
}

output = formatCode(generateCode(input));
```

### é”™è¯¯å¤„ç†
```javascript
try {
  // ä¸»è¦çš„ç”Ÿæˆé€»è¾‘
  output = generateMainCode(input);
  
  // éªŒè¯è¾“å‡º
  if (!output || typeof output !== 'string') {
    throw new Error('è¾“å‡ºå¿…é¡»æ˜¯éç©ºå­—ç¬¦ä¸²');
  }
  
} catch (error) {
  console.error('è„šæœ¬æ‰§è¡Œé”™è¯¯:', error.message);
  output = `// è„šæœ¬æ‰§è¡Œé”™è¯¯: ${error.message}\n` +
           `// è¯·æ£€æŸ¥è„šæœ¬è¯­æ³•å’Œé€»è¾‘\n`;
}
```

## ğŸš¨ å¸¸è§é—®é¢˜

### Q: è„šæœ¬æ‰§è¡Œæ²¡æœ‰è¾“å‡ºæ€ä¹ˆåŠï¼Ÿ
A: æ£€æŸ¥æ˜¯å¦è®¾ç½®äº† `output` å˜é‡ï¼Œç¡®ä¿è„šæœ¬æœ€åæœ‰ `output = "ä»£ç "` è¯­å¥

### Q: å¦‚ä½•è°ƒè¯•è„šæœ¬ï¼Ÿ
A: ä½¿ç”¨ `console.log()` è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥åœ¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹

### Q: å¯¼å…¥çš„è„šæœ¬åœ¨å“ªé‡Œï¼Ÿ
A: å¯¼å…¥çš„è„šæœ¬ä¿å­˜åœ¨ `~/.godbmodeler/scripts/imported/` ç›®å½•

### Q: æ”¯æŒå“ªäº› JavaScript ç‰¹æ€§ï¼Ÿ
A: æ”¯æŒæ ‡å‡†çš„ ES6+ è¯­æ³•ï¼ŒåŒ…æ‹¬ç®­å¤´å‡½æ•°ã€æ¨¡æ¿å­—ç¬¦ä¸²ã€è§£æ„ç­‰

### Q: å¦‚ä½•åˆ†äº«è„šæœ¬ï¼Ÿ
A: å¯¼å‡ºè„šæœ¬æ–‡ä»¶åˆ†äº«ç»™å…¶ä»–ç”¨æˆ·ï¼Œä»–ä»¬å¯ä»¥é€šè¿‡å¯¼å…¥åŠŸèƒ½ä½¿ç”¨

## ğŸ“‹ æœ€ä½³å®è·µ

1. **å‘½åè§„èŒƒ**: ä½¿ç”¨æœ‰æ„ä¹‰çš„è„šæœ¬åç§°ï¼Œå¦‚ `user-entity-with-comments`
2. **æ³¨é‡Šè¯´æ˜**: åœ¨è„šæœ¬å¼€å¤´æ·»åŠ ä½¿ç”¨è¯´æ˜å’Œç¤ºä¾‹
3. **é”™è¯¯å¤„ç†**: æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†é€»è¾‘
4. **æ¨¡å—åŒ–**: å°†å¤æ‚é€»è¾‘æ‹†åˆ†ä¸ºå¤šä¸ªå‡½æ•°
5. **æµ‹è¯•éªŒè¯**: åœ¨ä¿å­˜å‰æµ‹è¯•è„šæœ¬æ˜¯å¦æ­£å¸¸å·¥ä½œ

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥åº”ç”¨ç¨‹åºæ—¥å¿—
2. éªŒè¯è„šæœ¬è¯­æ³•æ˜¯å¦æ­£ç¡®
3. ç¡®ä¿è®¾ç½®äº† `output` å˜é‡
4. ä½¿ç”¨ç®€å•çš„ç¤ºä¾‹è„šæœ¬æµ‹è¯•

---
*æœ€åæ›´æ–°: 2025-09-09*